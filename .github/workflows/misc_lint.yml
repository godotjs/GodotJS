name: ğŸ«· Lint

on:
  workflow_call:

jobs:
  clang-format:
    name: ğŸ«· Lint
    runs-on: ubuntu-latest
    
    steps:
    - name: â¬ Checkout repository
      uses: actions/checkout@v4
    
    - name: â™»ï¸ Run clang-format
      run: find . -iname '*.h' -o -iname '*.cpp' | grep -v -E '(quickjs|quickjs-ng|lws)/' | xargs clang-format -i
    
    - name: ğŸ” Check for formatting changes
      run: |
        if ! git diff --exit-code; then
          echo "Code formatting issues found. Please run clang-format."
          exit 1
        fi